!function(e){"use strict";var n=function(){var e={modules:{},set:function(n,t){"get"===n?e.get=t:"post"===n&&(e.post=t)},"default":function(n){"get"===n?e.get=e.modules.get:"post"===n&&(e.get=e.modules.post)}};return e};e["jaxxy-"+(new Date).getTime()]=e.jaxxy=n()}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.xhr)return!1;var n={};n.on=function(e,n,t,o){e.addEventListener?e.addEventListener(n,t,o):e.attachEvent("on"+n,function(){t.call(e)})},n.off=function(e,n,t){e.removeEventListener?e.removeEventListener(n,t):e.detachEvent("on"+n,t)},jaxxy.modules.events=n}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.get)return!1;var n=function(e,n,t){var o=[],r=[],s={then:function(e){return"function"==typeof e&&o.push(e),s},error:function(e){return"function"==typeof e&&r.push(e),s}},u=function(e){return function(n,t){for(var o=0;o<e.length;o++)e[o](n,t)}};return s.success=s.then,jaxxy.modules.xhr("GET",e,n,t,u(o),u(r)),s};jaxxy.modules.get=n,jaxxy.set("get",n)}(window),function(window){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.jsonfn)return!1;var jsonfn={};jsonfn.stringify=function(e){return JSON.stringify(e,function(e,n){return n instanceof Function||"function"==typeof n?n.toString():n instanceof RegExp?"_PxEgEr_"+n:n})},jsonfn.parse=function(str,date2obj){var iso8061=date2obj?/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/:!1;return JSON.parse(str,function(key,value){var prefix;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix?eval(value.slice(8)):value)})},jsonfn.clone=function(e,n){return jsonfn.parse(jsonfn.stringify(e),n)},jaxxy.modules.jsonfn=jsonfn}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.mule)return!1;var n={ready:!1,postQueue:[],getQueue:[],messageQueue:{}},t=jaxxy.modules.events;n.randomTo=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n.genID=function(){return(new Date).getTime()+"-"+n.randomTo(1e5,999999)+"-"+n.randomTo(1e5,999999)+"-"+n.randomTo(1e5,999999)},n.post=function(e,t,o){if(!n.ready)return n.postQueue.push([e,t,o]),n;var r=n.genID(),s={then:function(e){return"function"==typeof e&&n.messageQueue[r].success.push(e),s},error:function(e){return"function"==typeof e&&n.messageQueue[r].error.push(e),s}},u=jaxxy.modules.jsonfn.stringify({id:r,parentID:n.parentID,url:e,data:t,func:function(e){jaxxy.post(e.url,e.data,e.async).success(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:n}),"*")}).error(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:!1,error:n}),"*"),console&&console.log(JSON.stringify(n))})}});return n.element.contentWindow.postMessage(u,"*"),n.messageQueue[r]={success:[o],error:[]},s.success=s.then,s},n.get=function(e,t){if(!n.ready)return n.getQueue.push([e,data,t]),n;var o=n.genID(),r={then:function(e){return"function"==typeof e&&n.messageQueue[o].success.push(e),r},error:function(e){return"function"==typeof e&&n.messageQueue[o].error.push(e),r}},s=jaxxy.modules.jsonfn.stringify({id:o,parentID:n.parentID,url:e,func:function(e){jaxxy.get(e.url,e.async).success(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:n}),"*")}).error(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:!1,error:n}),"*"),console&&console.log(JSON.stringify(n))})}});return n.element.contentWindow.postMessage(s,"*"),n.messageQueue[o]={success:[t],error:[]},r.success=r.then,r},n.init=function(o,r,s){return o?(r&&jaxxy.set("get",n.get),s&&jaxxy.set("post",n.post),n.muleServer=o,n.parentID=n.genID(),t.on(e,"message",n.__muleReceiver),n.element=document.createElement("iframe"),n.element.src=n.muleServer,n.element.style.display="none",t.on(n.element,"load",function(){n.ready=!0;for(var e in n.getQueue)n.get(n.getQueue[e][0],n.getQueue[e][1],n.getQueue[e][2]);for(var e in n.postQueue)n.post(n.postQueue[e][0],n.postQueue[e][1],n.postQueue[e][2]);n.element.onload=null}),void document.body.appendChild(n.element)):console.warn("Ignored - no server was specified")},n.__muleReceiver=function(e){if(e.data)try{var t=jaxxy.modules.jsonfn.parse(e.data);if(t&&n.messageQueue[t.id]&&t.id)if(t.error)for(var o in n.messageQueue[t.id].error)n.messageQueue[t.id].error[o](t.error,t);else for(var o in n.messageQueue[t.id].success)n.messageQueue[t.id].success[o](t.data,t)}catch(r){if(null!==typeof console&&void 0!==typeof console){console.error(r.message);for(var o in n.messageQueue[t.id][o].error)n.messageQueue[t.id].error[o](r,t)}}},jaxxy.modules.mule=n}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.post)return!1;var n=function(e,n,t){var o=[],r=[],s={then:function(e){return"function"==typeof e&&o.push(e),s},error:function(e){return"function"==typeof e&&r.push(e),s}},u=function(e){return function(n,t){for(var o=0;o<e.length;o++)e[o](n,t)}};s.success=s.then;var a=new FormData;for(var i in n)a.append(i,n[i]);return jaxxy.modules.xhr("POST",e,a,t,u(o),u(r)),s};jaxxy.modules.post=n,jaxxy.set("post",n)}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.xhr)return!1;var n=function(e,n,t,o,r,s){var u=new XMLHttpRequest,a="null"==typeof o||"undefined"==typeof o||o?!0:!1;u.open(e,n,a),u.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?"function"==typeof r&&r(this.responseText,this):"function"==typeof s&&s(this))},u.send(t),u=null};jaxxy.modules.xhr=n}(window);
//# sourceMappingURL=jaxxy.min.js.map