!function(e){"use strict";var n=function(){var e={modules:{},set:function(n,t){"get"===n?e.get=t:"post"===n&&(e.post=t)},"default":function(n){"get"===n?e.get=e.modules.get:"post"===n&&(e.get=e.modules.post)}};return e};e["jaxxy-"+(new Date).getTime()]=e.jaxxy=n()}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.xhr)return!1;var n={};n.on=function(e,n,t,u){e.addEventListener?e.addEventListener(n,t,u):e.attachEvent("on"+n,function(){t.call(e)})},n.off=function(e,n,t){e.removeEventListener?e.removeEventListener(n,t):e.detachEvent("on"+n,t)},jaxxy.modules.events=n}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.get)return!1;var n=function(e,n,t){var u=[],o=[],r={then:function(e){return"function"==typeof e&&u.push(e),r},error:function(e){return"function"==typeof e&&o.push(e),r}},s=function(e){return function(n,t){for(var u=0;u<e.length;u++)e[u](n,t)}};return r.success=r.then,jaxxy.modules.xhr("GET",e,n,t,s(u),s(o)),r};jaxxy.modules.get=n,jaxxy.set("get",n)}(window),function(window){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.jsonfn)return!1;var jsonfn={};jsonfn.stringify=function(e){return JSON.stringify(e,function(e,n){return n instanceof Function||"function"==typeof n?n.toString():n instanceof RegExp?"_PxEgEr_"+n:n})},jsonfn.parse=function(str,date2obj){var iso8061=date2obj?/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/:!1;return JSON.parse(str,function(key,value){var prefix;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix?eval(value.slice(8)):value)})},jsonfn.clone=function(e,n){return jsonfn.parse(jsonfn.stringify(e),n)},jaxxy.modules.jsonfn=jsonfn}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.mule)return!1;var n={ready:!1,postQueue:[],getQueue:[],messageQueue:{}},t=jaxxy.modules.events;n.randomTo=function(e,n){return Math.floor(Math.random()*(n-e+1)+e)},n.genID=function(){return(new Date).getTime()+"-"+n.randomTo(1e5,999999)+"-"+n.randomTo(1e5,999999)+"-"+n.randomTo(1e5,999999)},n.post=function(e,t,u){if(!n.ready)return n.postQueue.push([e,t,u]),n;var o=n.genID(),r={then:function(e){return"function"==typeof e&&n.messageQueue[o].then.push(e),r},success:function(e){return"function"==typeof e&&n.messageQueue[o].success.push(e),r},error:function(e){return"function"==typeof e&&n.messageQueue[o].error.push(e),r}},s=jaxxy.modules.jsonfn.stringify({id:o,parentID:n.parentID,url:e,data:t,func:function(e){jaxxy.post(e.url,e.data,e.async).success(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:n}),"*")}).error(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:!1,error:n}),"*"),console&&console.log(JSON.stringify(n))})}});return n.element.contentWindow.postMessage(s,"*"),n.messageQueue[o]={success:[],error:[],then:[]},r.then(u),r},n.get=function(e,t,u){if(!n.ready)return n.getQueue.push([e,t,u]),n;var o=n.genID(),r={then:function(e){return"function"==typeof e&&n.messageQueue[o].then.push(e),r},success:function(e){return"function"==typeof e&&n.messageQueue[o].success.push(e),r},error:function(e){return"function"==typeof e&&n.messageQueue[o].error.push(e),r}},s=jaxxy.modules.jsonfn.stringify({id:o,parentID:n.parentID,data:t,url:e,func:function(e){jaxxy.get(e.url,e.data,e.async).success(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:n}),"*")}).error(function(n){parent.postMessage(jaxxy.modules.jsonfn.stringify({parentID:e.parentID,id:e.id,data:!1,error:n}),"*"),console&&console.log(JSON.stringify(n))})}});return n.element.contentWindow.postMessage(s,"*"),n.messageQueue[o]={success:[],error:[],then:[]},r.then(u),r},n.init=function(u,o,r){return u?(o&&jaxxy.set("get",n.get),r&&jaxxy.set("post",n.post),n.muleServer=u,n.parentID=n.genID(),t.on(e,"message",n.__muleReceiver),n.element=document.createElement("iframe"),n.element.src=n.muleServer,n.element.style.display="none",t.on(n.element,"load",function(){n.ready=!0;for(var e in n.getQueue)n.get(n.getQueue[e][0],n.getQueue[e][1],n.getQueue[e][2]);for(var e in n.postQueue)n.post(n.postQueue[e][0],n.postQueue[e][1],n.postQueue[e][2]);n.element.onload=null}),void document.body.appendChild(n.element)):console.warn("Ignored - no server was specified")},n.__muleReceiver=function(e){if(e.data)try{var t=jaxxy.modules.jsonfn.parse(e.data);if(t&&n.messageQueue[t.id]&&t.id){if(t.error)for(var u in n.messageQueue[t.id].error)(n.messageQueue[t.id].error[u]||function(){})(t.error,t);else for(var u in n.messageQueue[t.id].success)(n.messageQueue[t.id].success[u]||function(){})(t.data,t);for(var u in n.messageQueue[t.id].then)(n.messageQueue[t.id].then[u]||function(){})(t.error,t.data,t)}}catch(o){if(null!==typeof console&&void 0!==typeof console){console.error(o.message);for(var u in n.messageQueue[t.id][u].error)(n.messageQueue[t.id].error[u]||function(){})(o,t)}}},jaxxy.modules.mule=n}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.post)return!1;var n=function(e,n,t){var u=[],o=[],r={success:function(e){return"function"==typeof e&&u.push(e),r},then:function(e){return"function"==typeof e&&u.push(e),r},error:function(e){return"function"==typeof e&&o.push(e),r}},s=function(e){return function(n,t){for(var u=0;u<e.length;u++)e[u](n,t)}};r.success=r.then;var a=new FormData;for(var i in n)a.append(i,n[i]);return jaxxy.modules.xhr("POST",e,a,t,s(u),s(o)),r};jaxxy.modules.post=n,jaxxy.set("post",n)}(window),function(e){"use strict";if("undefined"==typeof jaxxy||jaxxy.modules.xhr)return!1;var n=function(e,n,t,u,o,r){var s=new XMLHttpRequest,a="null"==typeof u||"undefined"==typeof u||u?!0:!1;s.open(e,n,a),s.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?"function"==typeof o&&o(this.responseText,this):"function"==typeof r&&r(this))},s.send(t),s=null};jaxxy.modules.xhr=n}(window);
//# sourceMappingURL=jaxxy.min.js.map